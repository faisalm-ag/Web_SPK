@using WebAppSPK.ViewModels
@model FinalResultVM

@{
    ViewData["Title"] = "Consultancy Report - " + Model.Nama;
}

<style>
    :root {
        --accent-pink: #f472b6;
        --accent-indigo: #6366f1;
        --bg-dark: #020617;
        --card-bg: rgba(30, 41, 59, 0.45);
        --metallic-green: #22c55e;
        --metallic-red: #ef4444;
        --metallic-blue: #3b82f6;
    }

    body {
        background: radial-gradient(circle at top right, #111827, #020617);
        color: #f8fafc;
        font-family: 'Plus Jakarta Sans', sans-serif;
    }

    .report-card {
        background: var(--card-bg);
        backdrop-filter: blur(16px);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 28px;
        padding: 2rem;
        transition: all 0.4s ease;
    }

    /* Metallic Badges & Items */
    .strength-item { 
        color: var(--metallic-green); 
        background: rgba(34, 197, 94, 0.15); 
        padding: 8px 14px; 
        border-radius: 10px; 
        font-size: 0.9rem; 
        border: 1px solid rgba(34, 197, 94, 0.3);
        box-shadow: 0 0 15px rgba(34, 197, 94, 0.1);
    }
    .weakness-item { 
        color: var(--metallic-red); 
        background: rgba(239, 68, 68, 0.15); 
        padding: 8px 14px; 
        border-radius: 10px; 
        font-size: 0.9rem; 
        border: 1px solid rgba(239, 68, 68, 0.3);
        box-shadow: 0 0 15px rgba(239, 68, 68, 0.1);
    }

    /* Modern Conclusion Box (The requested change) */
    .conclusion-box {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(30, 41, 59, 0.6));
        border-left: 4px solid var(--metallic-blue);
        border-top: 1px solid rgba(255,255,255,0.1);
        border-right: 1px solid rgba(255,255,255,0.05);
        border-bottom: 1px solid rgba(255,255,255,0.05);
        border-radius: 16px;
        padding: 1.25rem;
        margin-top: 1.5rem;
        box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
    }

    .summary-badge {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 16px;
        padding: 12px;
        text-align: center;
    }

    .disclaimer-box {
        background: linear-gradient(to right, rgba(99, 102, 241, 0.1), rgba(244, 114, 182, 0.1));
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 20px;
        padding: 2rem;
        margin-top: 3rem;
    }

    .score-badge {
        background: linear-gradient(135deg, var(--accent-pink), var(--accent-indigo));
        padding: 0.5rem 1.5rem;
        border-radius: 100px;
        font-weight: 700;
    }

    .radar-container {
        background: rgba(15, 23, 42, 0.6);
        border-radius: 20px;
        padding: 1.5rem;
    }

    @@media print {
        .no-print { display: none !important; }
        body { background: white; color: black; }
        .report-card { border: 1px solid #ddd; background: white; color: black; backdrop-filter: none; }
    }
</style>

<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-5 no-print">
        <div>
            <span class="badge score-badge mb-2 text-uppercase">Decision Support System Report</span>
            <h1 class="display-5 fw-bold m-0">Hasil Analisis <span class="text-info">Karir Jepang</span></h1>
        </div>
        <button onclick="window.print()" class="btn btn-light rounded-pill px-4">
            <i class="bi bi-printer me-2"></i>Cetak Laporan
        </button>
    </div>

    <div class="row g-4">
        <div class="col-lg-4">
            <div class="report-card h-100 shadow-lg">
                <div class="text-center mb-4">
                    <img src="https://ui-avatars.com/api/?name=@Model.Nama&background=6366f1&color=fff&size=100" class="rounded-circle mb-3 border border-3 border-info" />
                    <h3 class="fw-bold m-0">@Model.Nama</h3>
                    <p class="text-info small">Target: @Model.BidangPekerjaan</p>
                </div>

                <div class="mb-4">
                    <h6 class="text-white-50 small fw-bold text-uppercase mb-3 text-center">Pilar Kesiapan Mental</h6>
                    <div class="radar-container">
                        <canvas id="radarMental" style="max-height: 220px;"></canvas>
                    </div>
                </div>

                <div class="p-3 rounded-4 bg-dark text-center border border-white border-opacity-10">
                    <div class="small text-white-50 mb-1">Skor Gabungan (Fusion)</div>
                    <div class="display-5 fw-bold text-info">@Model.EligibilityScore%</div>
                    <span class="badge bg-@Model.StatusColor px-3 py-2 mt-2">@Model.RecommendationCategory</span>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="report-card mb-4">
                <h5 class="fw-bold mb-4"><i class="bi bi-grid-1x2-fill me-2 text-info"></i>Ringkasan Data Ekonomi (@Model.LokasiPilihan)</h5>
                <div class="row g-3">
                    <div class="col-6 col-md-3">
                        <div class="summary-badge">
                            <i class="bi bi-cash text-success d-block mb-1 fs-4"></i>
                            <span class="d-block x-small text-white-50">Gaji (C1)</span>
                            <small class="fw-bold text-info">@Model.ScoreC1.ToString("F1")% Fit</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="summary-badge">
                            <i class="bi bi-cart text-danger d-block mb-1 fs-4"></i>
                            <span class="d-block x-small text-white-50">Biaya Hidup (C2)</span>
                            <small class="fw-bold text-info">@Model.ScoreC2.ToString("F1")% Fit</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="summary-badge">
                            <i class="bi bi-building text-warning d-block mb-1 fs-4"></i>
                            <span class="d-block x-small text-white-50">Peluang (C3)</span>
                            <small class="fw-bold text-info">@Model.ScoreC3.ToString("F1")% Fit</small>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="summary-badge">
                            <i class="bi bi-people text-info d-block mb-1 fs-4"></i>
                            <span class="d-block x-small text-white-50">Lingkungan (C4)</span>
                            <small class="fw-bold text-info">@Model.ScoreC4.ToString("F1")% Fit</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="report-card mb-4">
                <h5 class="fw-bold mb-3 text-pink"><i class="bi bi-chat-left-quote me-2"></i>Analisis Kelayakan</h5>
                <p class="small lh-lg" style="text-align: justify; color: #cbd5e1;">@Model.ScoreExplanation</p>
                
                @* PERBAIKAN: Card Kesimpulan Wilayah *@
                <div class="conclusion-box">
                    <div class="d-flex align-items-start">
                        <i class="bi bi-geo-alt-fill text-info me-3 fs-4"></i>
                        <div>
                            <strong class="text-info d-block mb-1" style="letter-spacing: 0.5px; font-size: 0.85rem; text-uppercase;">Kesimpulan Wilayah</strong>
                            <p class="m-0 small text-white-50 lh-base">@Model.SummaryMessage</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="report-card mb-4">
                <h5 class="fw-bold mb-3"><i class="bi bi-person-check me-2"></i>Keseimbangan Karakter</h5>
                <p class="text-white-50 small mb-4">@Model.SectionIntroPersonal</p>
                
                <div class="row g-3">
                    <div class="col-md-6">
                        <h6 class="small fw-bold text-success text-uppercase mb-3">Kelebihan Utama</h6>
                        <div class="d-flex flex-column gap-2">
                            @foreach(var s in Model.PersonalStrengths) {
                                <div class="strength-item"><i class="bi bi-shield-check me-2"></i>@s</div>
                            }
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6 class="small fw-bold text-danger text-uppercase mb-3">Hal Perlu Diwaspadai</h6>
                        <div class="d-flex flex-column gap-2">
                            @foreach(var w in Model.PersonalWeaknesses) {
                                <div class="weakness-item"><i class="bi bi-exclamation-octagon me-2"></i>@w</div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="disclaimer-box text-center">
        <h4 class="fw-bold mb-3">Keputusan Akhir Ada Di Tangan Anda</h4>
        <p class="mx-auto text-white-50 mb-4" style="max-width: 800px; line-height: 1.8;">
            @Model.DecisionDisclaimer
        </p>
        <div class="d-flex justify-content-center gap-3 no-print">
            <a href="/" class="btn btn-outline-light rounded-pill px-4">Kembali ke Home</a>
            <button onclick="window.print()" class="btn btn-info rounded-pill px-4 fw-bold text-dark">Simpan Sebagai PDF</button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctxRadar = document.getElementById('radarMental').getContext('2d');
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: ['Disiplin', 'Ketahanan', 'Adaptasi'],
                datasets: [{
                    label: 'Profil Anda',
                    data: [@Model.ScoreDisiplinEtika.ToString("F1", System.Globalization.CultureInfo.InvariantCulture), 
                          @Model.ScoreKetahananDiri.ToString("F1", System.Globalization.CultureInfo.InvariantCulture), 
                          @Model.ScoreAdaptasiSosial.ToString("F1", System.Globalization.CultureInfo.InvariantCulture)],
                    backgroundColor: 'rgba(99, 102, 241, 0.2)',
                    borderColor: '#6366f1',
                    pointBackgroundColor: '#6366f1',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#6366f1',
                    borderWidth: 3
                }]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true, 
                        max: 5,
                        min: 0,
                        ticks: { stepSize: 1, display: false },
                        grid: { color: 'rgba(255,255,255,0.1)' },
                        angleLines: { color: 'rgba(255,255,255,0.1)' },
                        pointLabels: { color: '#94a3b8', font: { size: 12, weight: 'bold' } }
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    </script>
}