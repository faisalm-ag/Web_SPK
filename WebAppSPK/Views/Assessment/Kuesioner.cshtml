@model List<WebAppSPK.ViewModels.QuestionVM>
@{
    ViewData["Title"] = "Deep Assessment - Kesiapan Karir";
}

<style>
    :root { 
        --cyan-neon: #22d3ee; 
        --bg-dark: #020617; 
        --accent-pink: #FF1493;
        --glass-border: rgba(255, 255, 255, 0.08);
    }
    
    body { background-color: var(--bg-dark); color: white; }

    /* Stepper UI */
    .stepper-wrapper { display: flex; justify-content: space-between; margin-bottom: 3rem; position: relative; }
    .stepper-item { position: relative; display: flex; flex-direction: column; align-items: center; flex: 1; z-index: 1; }
    .stepper-item::before { position: absolute; content: ""; border-bottom: 2px solid var(--glass-border); width: 100%; top: 20px; left: -50%; z-index: -1; }
    .stepper-item:first-child::before { content: none; }
    .step-counter { width: 40px; height: 40px; border-radius: 50%; background: #111; border: 2px solid var(--glass-border); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: 0.3s; }
    .stepper-item.active .step-counter { background: var(--accent-pink); border-color: var(--accent-pink); box-shadow: 0 0 15px var(--accent-pink); }
    .stepper-item.completed .step-counter { background: #059669; border-color: #059669; }

    /* Sticky Progress */
    .sticky-progress { position: fixed; top: 0; left: 0; width: 100%; height: 6px; background: rgba(255,255,255,0.05); z-index: 2000; }
    #progressFill { height: 100%; width: 0%; background: linear-gradient(90deg, #22d3ee, #FF1493); box-shadow: 0 0 15px var(--cyan-neon); transition: width 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

    /* Card Styling - High Symmetry */
    .question-card { 
        background: linear-gradient(145deg, rgba(30,41,59,0.4), rgba(15,23,42,0.6)); 
        backdrop-filter: blur(15px); 
        border-radius: 24px; 
        padding: 30px; 
        border: 1px solid var(--glass-border);
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        height: 100%; /* Memaksa tinggi sama dalam baris yang sama */
    }
    .question-card:hover { border-color: var(--cyan-neon); transform: translateY(-5px); background: rgba(30,41,59,0.6); }
    .question-number { position: absolute; right: -5px; top: -15px; font-size: 4.5rem; font-weight: 900; color: rgba(255,255,255,0.03); pointer-events: none; }

    .section-divider { border-left: 5px solid var(--accent-pink); padding-left: 15px; margin: 60px 0 30px; letter-spacing: 2px; }

    /* Likert Scale Interactive */
    .likert-container { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: auto; padding-top: 25px; }
    .likert-label { font-size: 0.65rem; font-weight: 700; color: rgba(255,255,255,0.4); text-transform: uppercase; width: 75px; text-align: center; line-height: 1.2; }
    
    .likert-options { display: flex; gap: 8px; }
    .likert-btn {
        width: 46px; height: 46px;
        display: flex; align-items: center; justify-content: center;
        border-radius: 50%;
        border: 2px solid var(--glass-border);
        cursor: pointer; color: white; font-weight: 700;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: rgba(255,255,255,0.02);
    }
    .likert-btn:hover { border-color: var(--cyan-neon); color: var(--cyan-neon); transform: scale(1.1); }
    
    .btn-check:checked + .likert-btn {
        background: var(--cyan-neon); border-color: var(--cyan-neon);
        color: var(--bg-dark); box-shadow: 0 0 20px var(--cyan-neon);
        transform: scale(1.15);
    }

    .btn-generate {
        background: linear-gradient(45deg, var(--accent-pink), #8b5cf6);
        color: white; border: none; border-radius: 50px;
        font-weight: 800; padding: 18px 45px;
        letter-spacing: 2px; transition: 0.4s;
        box-shadow: 0 10px 30px rgba(255, 20, 147, 0.3);
    }
    .btn-generate:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 15px 40px rgba(255, 20, 147, 0.5); color: white; }
    
    .card-category { font-size: 0.7rem; font-weight: 800; color: var(--cyan-neon); letter-spacing: 1.5px; margin-bottom: 10px; display: block; }
</style>

<div class="sticky-progress"><div id="progressFill"></div></div>

<div class="container py-5">
    <div class="row justify-content-center mb-5">
        <div class="col-md-8 text-center">
            <div class="stepper-wrapper mb-4">
                <div class="stepper-item completed"><div class="step-counter"><i class="bi bi-check-lg"></i></div><div class="step-name small">Biodata</div></div>
                <div class="stepper-item active"><div class="step-counter">2</div><div class="step-name small">Kuesioner</div></div>
                <div class="stepper-item"><div class="step-counter">3</div><div class="step-name small">Analisis</div></div>
                <div class="stepper-item"><div class="step-counter">4</div><div class="step-name small">Hasil</div></div>
            </div>
            <h1 class="display-4 fw-900 text-white mb-2">Mental <span style="color:var(--accent-pink)">Readiness</span></h1>
            <p class="text-white-50">Lengkapi asesmen di bawah ini untuk memulai kalkulasi algoritma rekomendasi.</p>
        </div>
    </div>

    <form asp-action="Kuesioner" method="post" id="kuesionerForm">
        @Html.AntiForgeryToken()

        <h4 class="section-divider text-white fw-bold">PHASE 01: ECONOMIC PRIORITIES</h4>
        <div class="row g-4">
            @for (int i = 0; i < 4; i++)
            {
                <div class="col-md-6 d-flex"> @{ 
                        var deepQuestion = i switch {
                            0 => "Seberapa krusial selisih gaji bagi Anda? Apakah Anda rela mengabaikan kenyamanan demi angka pendapatan yang maksimal?",
                            1 => "Seberapa sensitif Anda terhadap pengeluaran harian? Apakah biaya hidup murah lebih tenang bagi mental Anda dibanding gaji besar?",
                            2 => "Seberapa besar keinginan Anda memiliki banyak opsi cadangan kerja jika suatu saat tempat kerja utama mengalami kendala?",
                            3 => "Seberapa butuh Anda akan interaksi sosial dan keramaian kota? Mampukah Anda bertahan di pedesaan Jepang yang sunyi?",
                            _ => Model[i].Text
                        };
                    }
                    <input type="hidden" name="[@i].Index" value="@Model[i].Index" />
                    <input type="hidden" name="[@i].Category" value="@Model[i].Category" />
                    <input type="hidden" name="[@i].Text" value="@deepQuestion" />

                    <div class="question-card">
                        <div class="question-number">0@(i+1)</div>
                        <span class="card-category">@Model[i].Category.ToUpper()</span>
                        <p class="text-white fs-5 fw-bold mb-4">@deepQuestion</p>
                        
                        <div class="likert-container">
                            <div class="likert-label">Sangat Tidak Penting</div>
                            <div class="likert-options">
                                @for (int s = 1; s <= 5; s++)
                                {
                                    var radioId = $"q_{i}_{s}";
                                    <input type="radio" name="[@i].SelectedScore" id="@radioId" value="@s" class="btn-check q-input" required>
                                    <label class="likert-btn" for="@radioId">@s</label>
                                }
                            </div>
                            <div class="likert-label">Sangat Penting</div>
                        </div>
                    </div>
                </div>
            }
        </div>

        <h4 class="section-divider text-white fw-bold">PHASE 02: ADAPTATION RESILIENCE</h4>
        <div class="row g-4">
            @for (int i = 4; i < Model.Count; i++)
            {
                <div class="col-md-6 d-flex"> @{ 
                        var deepQuestion = i switch {
                            4 => "Bayangkan jam 9 malam, fisik Anda lelah setelah bekerja. Masihkah Anda memiliki disiplin untuk belajar Kanji secara mandiri?",
                            5 => "Budaya kerja Jepang sangat ketat. Sanggupkah Anda mematikan total smartphone selama 8 jam penuh demi profesionalisme?",
                            6 => "Saat rindu rumah menyerang hebat di bulan ketiga, apakah komitmen kontrak tetap menjadi harga mati yang tidak bisa ditawar?",
                            7 => "Siapkah fisik Anda dipaksa bekerja dalam posisi statis atau membungkuk di bawah tekanan suhu ekstrem Jepang?",
                            8 => "Jika seseorang menawarkan penghasilan 2x lipat namun ilegal, apakah integritas Anda cukup kuat untuk tetap di jalur hukum?",
                            9 => "Mampukah Anda berdamai dengan rasa bosan terhadap makanan Jepang setiap hari tanpa merusak mood kerja Anda?",
                            10 => "Detail adalah segalanya di Jepang. Sanggupkah Anda teliti memisahkan berbagai jenis sampah setiap hari tanpa mengeluh?",
                            11 => "Saat terjadi kesalahan, siapkah Anda menurunkan ego untuk segera melapor (Hou-Ren-So) daripada menyembunyikannya?",
                            _ => Model[i].Text
                        };
                    }
                    <input type="hidden" name="[@i].Index" value="@Model[i].Index" />
                    <input type="hidden" name="[@i].Category" value="@Model[i].Category" />
                    <input type="hidden" name="[@i].Text" value="@deepQuestion" />

                    <div class="question-card">
                        <div class="question-number">@(i+1)</div>
                        <span class="card-category text-pink" style="color:var(--accent-pink)">@Model[i].Category.ToUpper()</span>
                        <p class="text-white fs-5 fw-bold mb-4">@deepQuestion</p>
                        
                        <div class="likert-container">
                            <div class="likert-label">Sangat Tidak Siap</div>
                            <div class="likert-options">
                                @for (int s = 1; s <= 5; s++)
                                {
                                    var radioId = $"q_{i}_{s}";
                                    <input type="radio" name="[@i].SelectedScore" id="@radioId" value="@s" class="btn-check q-input" required>
                                    <label class="likert-btn" for="@radioId">@s</label>
                                }
                            </div>
                            <div class="likert-label">Sangat Siap</div>
                        </div>
                    </div>
                </div>
            }
        </div>

        <div class="text-center mt-5 mb-5">
            <button type="submit" class="btn btn-generate btn-lg shadow-lg">
                FINALIZE DATA & RUN ANALYSIS <i class="bi bi-cpu-fill ms-2"></i>
            </button>
        </div>
    </form>
</div>

<script>
    function updateProgress() {
        const total = @Model.Count;
        const answered = document.querySelectorAll('input[type="radio"]:checked').length;
        const percent = (answered / total) * 100;
        const fill = document.getElementById('progressFill');
        fill.style.width = percent + "%";
        
        if(percent === 100) {
            fill.style.boxShadow = "0 0 30px #FF1493";
        }
    }

    document.querySelectorAll('.q-input').forEach(input => {
        input.addEventListener('change', function() {
            const card = this.closest('.question-card');
            card.style.borderColor = "rgba(34, 211, 238, 0.5)";
            card.style.background = "rgba(30, 41, 59, 0.7)";
            updateProgress();
        });
    });

    window.onload = updateProgress;
</script>